function toCreateTheBasicData(){context.clearRect(0,0,canvas.width,canvas.height),cellSize=17,count=0,score=0,timer=3,timerWindow.textContent="",snake={dir:"right",body:[{x:119,y:119},{x:119-cellSize,y:119},{x:119-2*cellSize,y:119}]},apple={x:getRandomNum(0,29)*cellSize,y:getRandomNum(0,29)*cellSize},timerWindow.style.display="flex"}function toChangeTheDir(){document.addEventListener("keydown",(e=>{"ArrowRight"!==e.key&&"d"!==e.key&&"в"!==e.key||"left"===snake.dir||"right"===snake.dir||(snake.dir="right",toDrawTheMovement(snake)),"ArrowLeft"!==e.key&&"a"!==e.key&&"ф"!==e.key||"right"===snake.dir||"left"===snake.dir||(snake.dir="left",toDrawTheMovement(snake)),"ArrowUp"!==e.key&&"w"!==e.key&&"ц"!==e.key||"down"===snake.dir||"up"===snake.dir||(snake.dir="up",toDrawTheMovement(snake)),"ArrowDown"!==e.key&&"s"!==e.key&&"ы"!==e.key||"up"===snake.dir||"down"===snake.dir||(snake.dir="down",toDrawTheMovement(snake))}))}function drawFood(){context.fillStyle="orangered";const e=cellSize/2-1,t=apple.x+e,n=apple.y+e;context.beginPath(),context.arc(t,n,e,0,getRadians(360)),context.fill()}function game(){let{body:e,dir:t}=snake,n=snake.body[0];animationId1=requestAnimationFrame(game),++count<4||(count=0,context.clearRect(0,0,canvas.width,canvas.height),drawFood(),e.forEach(((e,t)=>{context.fillStyle="darkorange",context.fillRect(e.x,e.y,cellSize-1,cellSize-1),0===t&&e.x===apple.x&&e.y===apple.y&&(score+=1),0!==t&&e.x===apple.x&&e.y===apple.y&&(apple.x=getRandomNum(0,29)*cellSize,apple.y=getRandomNum(0,29)*cellSize),0!==t&&1!==t&&n.x===e.x&&n.y===e.y&&(cancelAnimationFrame(animationId1),cancelAnimationFrame(animationId2),scoreText.textContent=score,scoreWindow.style.transform="translate(-50%, -50%)"),toMoveThroughTheWall(e)})),toDrawTheMovement(snake),toChangeTheDir(snake))}function toDrawTheMovement(){let e=snake.body[0];toMove(snake,e),snake.body.pop(),e.x===apple.x&&e.y===apple.y&&toMove(snake,e)}function toMove(e){let{body:t,dir:n}=e,a=e.body[0];switch(n){case"right":t.unshift({x:a.x+cellSize,y:a.y});break;case"left":t.unshift({x:a.x-cellSize,y:a.y});break;case"up":t.unshift({x:a.x,y:a.y-cellSize});break;case"down":t.unshift({x:a.x,y:a.y+cellSize})}}function toMoveThroughTheWall(e){e.x>=canvas.width?e.x=0:e.x<0&&(e.x=canvas.width-cellSize),e.y>=canvas.height?e.y=0:e.y<0&&(e.y=canvas.height-cellSize)}function toStartPlaying(){timerId=setInterval((()=>{timer>=1?(timerWindow.textContent=timer,timer--):(clearInterval(timerId),timerWindow.style.display="none",animationId2=requestAnimationFrame(game))}),1e3)}function getRandomNum(e,t){return Math.floor(Math.random()*(t-e+1))+e}function getRadians(e){return Math.PI/180*e}let cellSize,count,animationId1,animationId2,score,timer,timerId,snake,apple,canvas=document.querySelector("canvas"),context=canvas.getContext("2d"),scoreWindow=document.querySelector(".scoreWindow"),scoreText=document.querySelector(".scoreWindow p"),restartButton=document.querySelector(".scoreWindow__restart"),timerWindow=document.querySelector(".timerWindow");toCreateTheBasicData(),restartButton.addEventListener("click",(()=>{toCreateTheBasicData(),toStartPlaying(),scoreWindow.style.transform="translate(-50%, 100%)"}));