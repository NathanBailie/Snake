function toCreateTheBasicData(){context.clearRect(0,0,canvas.width,canvas.height),cellSize=17,count=0,score=0,timer=3,timerWindow.textContent="",snake={dir:"right",body:[{x:119,y:119},{x:119-cellSize,y:119},{x:119-2*cellSize,y:119}]},apple={x:getRandomNum(0,29)*cellSize,y:getRandomNum(0,29)*cellSize},timerWindow.style.display="flex"}function toChangeTheDir(){document.addEventListener("keydown",(e=>{"ArrowRight"!==e.key&&"d"!==e.key&&"в"!==e.key||"left"===snake.dir||"right"===snake.dir||(snake.dir="right",toDrawTheMovement(snake)),"ArrowLeft"!==e.key&&"a"!==e.key&&"ф"!==e.key||"right"===snake.dir||"left"===snake.dir||(snake.dir="left",toDrawTheMovement(snake)),"ArrowUp"!==e.key&&"w"!==e.key&&"ц"!==e.key||"down"===snake.dir||"up"===snake.dir||(snake.dir="up",toDrawTheMovement(snake)),"ArrowDown"!==e.key&&"s"!==e.key&&"ы"!==e.key||"up"===snake.dir||"down"===snake.dir||(snake.dir="down",toDrawTheMovement(snake))}))}function drawFood(){if(context.fillStyle=foodColor,"Circle"===foodType){const e=cellSize/2,t=apple.x+e,o=apple.y+e;context.beginPath(),context.arc(t,o,e,0,getRadians(360)),context.fill()}else"Square"===foodType&&context.fillRect(apple.x,apple.y,cellSize-1,cellSize-1)}function game(){let{body:e,dir:t}=snake,o=snake.body[0];animationId1=requestAnimationFrame(game),++count<4||(count=0,context.clearRect(0,0,canvas.width,canvas.height),drawFood(),e.forEach(((e,t)=>{context.fillStyle=snakeColor,context.fillRect(e.x,e.y,cellSize-1,cellSize-1),0===t&&e.x===apple.x&&e.y===apple.y&&(score+=1),0!==t&&e.x===apple.x&&e.y===apple.y&&(apple.x=getRandomNum(0,29)*cellSize,apple.y=getRandomNum(0,29)*cellSize),0!==t&&1!==t&&o.x===e.x&&o.y===e.y&&(cancelAnimationFrame(animationId1),cancelAnimationFrame(animationId2),scoreText.textContent=score,scoreWindow.style.transform="translate(-50%, -50%)"),toMoveThroughTheWall(e)})),toDrawTheMovement(snake),toChangeTheDir(snake))}function toDrawTheMovement(){let{body:e,dir:t}=snake,o=e[0];toMove(o,e,t),snake.body.pop(),o.x===apple.x&&o.y===apple.y&&(toMove(o,e,t),soundSwitcher&&onPlaySound(`../sounds/sound${numberOfSound}.mp3`))}function toMove(e,t,o){switch(o){case"right":t.unshift({x:e.x+cellSize,y:e.y});break;case"left":t.unshift({x:e.x-cellSize,y:e.y});break;case"up":t.unshift({x:e.x,y:e.y-cellSize});break;case"down":t.unshift({x:e.x,y:e.y+cellSize})}}function toChangeStartWindowBG(){document.querySelector(".startWindow").style.background=`url(../img/bg/snake${getRandomNum(1,9)}.png) center center / cover no-repeat`}function toMoveThroughTheWall(e){e.x>=canvas.width?e.x=0:e.x<0&&(e.x=canvas.width-cellSize),e.y>=canvas.height?e.y=0:e.y<0&&(e.y=canvas.height-cellSize)}function toStartPlaying(){timerId=setInterval((()=>{timer>=1?(timerWindow.textContent=timer,timer--):(clearInterval(timerId),timerWindow.style.display="none",animationId2=requestAnimationFrame(game))}),1e3),scoreWindow.style.transform="translate(-50%, 100%)",container.style.boxShadow="0px 0px 5px 2px #ffbbff"}function getRandomNum(e,t){return Math.floor(Math.random()*(t-e+1))+e}function getRadians(e){return Math.PI/180*e}function onPlaySound(e){let t=new Audio(e);t.autoplay=!0,t.volume=.5,t.play()}function conditionChecker(e,t){return""===e.target.classList.value&&e.target.parentElement.classList.contains(t)}function activeClassSwitcher(e,t){for(let e of t.children)e.classList.remove("active");e.target.classList.add("active")}let cellSize,count,animationId1,animationId2,score,timer,timerId,snake,apple,canvas=document.querySelector("canvas"),context=canvas.getContext("2d"),scoreWindow=document.querySelector(".scoreWindow"),settingWindow=document.querySelector(".settingsWindow"),timerWindow=document.querySelector(".timerWindow"),container=document.querySelector(".container"),mainWraper=document.querySelector(".mainWraper"),startButton=document.querySelector(".startWindow__startButton"),settingsButton=document.querySelector(".startWindow__settingsButton"),okButton=document.querySelector(".settingsWindow__okButton"),backButton=document.querySelector(".scoreWindow__back"),restartButton=document.querySelector(".scoreWindow__restart"),scoreText=document.querySelector(".scoreWindow p"),soundCheckbox=document.querySelector(".customCheckbox"),sounds=document.querySelector(".sounds"),fieldColors=document.querySelector(".fieldColor"),snakeColors=document.querySelector(".snakeColor"),foodColors=document.querySelector(".foodColor"),foodTypes=document.querySelector(".foodType"),gameWraper=document.querySelector(".gameWraper");toChangeStartWindowBG(),toCreateTheBasicData();let soundSwitcher=!1,numberOfSound=5,fieldColor="linear-gradient(220deg, #404040, #413f48)",snakeColor="darkorange",foodColor="orangered",foodType="Circle";restartButton.addEventListener("click",(()=>{toCreateTheBasicData(),toStartPlaying()})),startButton.addEventListener("click",(()=>{toCreateTheBasicData(),toStartPlaying(),mainWraper.style.transform="translateX(-50%)"})),backButton.addEventListener("click",(()=>{toCreateTheBasicData(),mainWraper.style.transform="translateX(0)",container.style.boxShadow="0 0 5px 2px #b9ad25",setTimeout((()=>{scoreWindow.style.transform="translate(-50%, 100%)"}),600),toChangeStartWindowBG()})),okButton.addEventListener("click",(()=>{settingWindow.style.transform="translate(-50%, 100%)"})),settingsButton.addEventListener("click",(()=>{settingWindow.style.transform="translate(-50%, -50%)"})),sounds.addEventListener("click",(e=>{if(conditionChecker(e,"sounds")){let t=e.target.textContent;numberOfSound=t,onPlaySound(`../sounds/sound${numberOfSound}.mp3`),activeClassSwitcher(e,sounds)}})),fieldColors.addEventListener("click",(e=>{if(conditionChecker(e,"fieldColor")){let t=getComputedStyle(e.target).getPropertyValue("background");fieldColor=t.match(/linear-gradient.+\)\)/)[0],gameWraper.style.background=fieldColor,activeClassSwitcher(e,fieldColors)}})),snakeColors.addEventListener("click",(e=>{if(conditionChecker(e,"snakeColor")){let t=getComputedStyle(e.target).getPropertyValue("background");snakeColor=t.match(/rgb\(\d{1,3}, \d{1,3}, \d{1,3}\)/)[0],activeClassSwitcher(e,snakeColors)}})),foodColors.addEventListener("click",(e=>{if(conditionChecker(e,"foodColor")){let t=getComputedStyle(e.target).getPropertyValue("background");foodColor=t.match(/rgb\(\d{1,3}, \d{1,3}, \d{1,3}\)/)[0],activeClassSwitcher(e,foodColors)}})),foodTypes.addEventListener("click",(e=>{conditionChecker(e,"foodType")&&(foodType=e.target.textContent,activeClassSwitcher(e,foodTypes))})),soundCheckbox.addEventListener("click",(e=>{soundSwitcher=e.target.checked}));